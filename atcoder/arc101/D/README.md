# ARC101 D
中央値を、自分より大きい数が半数以上あるものの中で最大の数値と考えれば2分探索が出来る、という発想が本番中に思い浮かばずにツラい悲しい思いをした。

なお、全ての連続する部分列の中で中央値がb以上となるものの個数を `O(N log N)` でカウントする方法がcodeforcesでの投稿のなかにあったらしい。

---

注目している数値をxとすると、x以上の値を+1, それ以外を-1に置換した場合、ある区間の総和が0以上であれば中央値がx以上になることが分かる。

区間の和を累積和で考えると、 `sum[i] <= sum[j] s.t i < j` となるようなiとjの組を探せば良いことになる。

BITを使えば、そのような組を `O(N log N)` で数えることができ、全体で `O(N log^2 N)` になる。

---

持っていたBITの実装が半開区間でなかったので微妙な使いにくさを感じた。
