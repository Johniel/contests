# AtCoder Beginner Contest 336 D - Pyramid
## 問題概要
1,2,...,k-1,k,k-1,...2,1という数列をサイズkのピラミッドと呼ぶ。長さ2*1e5以下の数列aが与えられるので、１つの要素を１だけ減らすか両端のどちらかを削除するという２つの操作を駆使して作れるピラミッドの最大サイズの答えよ。

## 考えたこと
両端という条件を途中で忘れて瞑想した。それでも難しいんだけど。前計算を両端から行ってmin?それとも頂点を決める？
手が止まってしまってEを先に解いた。そちらは見慣れたような問題だった。

しかし解説が賢くて言うことが無い。

## 感想
+ 山型の完成形を想像するあまり適切な計算式を考えられなかった。
+ 頂点を決めるアプローチの方が体に馴染むけれど実装が少し複雑になる。
+ 簡単な問題を簡単に解くのはやはり難しい。

### 高さを２分探索&頂点を全てためす&サイズを２分探索

これから実装しようと思うのでここまでの理解を書く。

`-1, 0,1,2,3,4,3,2,1,0`というピラミッドを思い浮かべる。ここから頂点を１つ右に動かすと、
`-2,-1,0,1,2,3,4,3,2,1`に変化する。左なら、
` 0, 1,2,3,4,3,2,1,0,-1`に変化する。

今回は右に動かすことを考える。そうすると１つ動かす操作は
+ (0,i)を-1
+ (i,n)に+1

という２つの操作で実現出来る。この数列をbとすると、本当にサイズkになっているかは頂点から左右に`b[i]<=a[i]`になる範囲を知れれば良い。
移行して`0<=a[i]-b[i]`になる。あとはatcoder libraryでいうところのmin_leftとmax_rightでminが0にならない範囲を２分探索してkより離れていればok。

サンプルのひとつで試すと、
```
5

```

#### k=2
サンプルと同じ`a={2,2,3,1,1}`を考える。また、segtreeで管理するa-bという数列をcとする。
##### 0が頂点
b[0]が頂点のサイズkのピラミッドは
`b={2,1,0,-1,-2}`。
`c={0,1,3,0,3}`

この時の２分探索の結果は
+ min_left:=0
+ max_right:=2

min_leftが頂点と近いのでng

##### 1が頂点
`b={1,2,1,0,-1}`。
`c={1,0,2,1,2}`

この時の２分探索の結果は
+ min_left:=0
+ max_right:=3

min_leftとmax_rightが頂点からk以上離れているのでok

##### 2が頂点
`b={0,1,2,1,0}`。
`c={2,1,1,0,0}`

この時の２分探索の結果は
+ min_left:=0
+ max_right:=n

min_leftとmax_rightが頂点からk以上離れているのでok

##### 3が頂点
`b={-1,0,1,2,1}`。
`c={3,2,1,-1,0}`

この時の２分探索の結果は
+ min_left:=3
+ max_right:=3

min_leftとmax_rightが頂点と近いのでng

## 感想2
+ a-bが賢い。
